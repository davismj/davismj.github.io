<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0'>

    <title>Aurelia Custom Attributes â€“ Matthew James Davis</title>

    <meta name="author" content="Matthew James Davis" />
    <meta name="description" content="Introduction to custom Aurelia-enabled HTML attributes." />
    <meta name="keywords" content="aurelia,data-binding,custom-attribute,es7,decorators" />

    <!--[if lt IE 9]>
      <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <link href='https://fonts.googleapis.com/css?family=Raleway:500,600' rel='stylesheet' type='text/css'>
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="stylesheet" type="text/css" href="/desktop.css" media="screen and (min-width: 641px) and (min-height: 641px)" />
    <link rel="stylesheet" type="text/css" href="/mobile.css" media="screen and (max-width: 640px), screen and (max-height: 640px)" />
    <link rel="alternate" type="application/rss+xml" title="Matthew James Davis" href="/feed.xml" />
  </head>

  <body>
    <nav>
      <div>
        <a href="/"><img class="avatar" src="/images/me.jpg" />
        <h1 class="text-center">Matthew James Davis</h1></a>
        <p class="hide-mobile">Aurelia core team member Matthew James Davis is out to educate the community.</p>
        <ul>
          <a href="/blog/"><li class="active">Blog</li></a>
          <a href="/portfolio/"><li class="">Portfolio</li></a>
          <a href="/contact/"><li class="">Contact Me</li></a>
        </ul>
      </div>
    </nav>
    
    <main>
      <article>
	<header>
		Aurelia Custom Attributes
		<time>11 Apr 2015</time>
	</header>
	<p>We&#39;re going to create a simple demo that allows us to write and preview markdown in real time. To accomplish this, we are going to create an Aurelia <strong>Custom Attribute</strong> that reads and formats markdown. This particular example uses the new ES7 syntax in the Babel 5.0 transpiler.</p>

<h1>What is a Custom Attribute?</h1>

<p>Many HTML elements come with attributes that affect how the element looks or behaves. A common example is the <code>&lt;input /&gt;</code> element. Without any attributes, the <code>&lt;input /&gt;</code> element is a simple text box. However, if we modify the type attribute <code>&lt;input type=&quot;button&quot; /&gt;</code>, the input element becomes a button. Using an attribute allows us to describe the look and behavior of the element without writing any code.</p>

<p>One of the hallmarks of a well written Aurelia application is a clear <em>separation of concerns</em>; the code that describes the logic of our application should not need to know about the specifics of where and how it is used in the HTML. To help us achieve this, Aurelia allows us to define new HTML attributes, called <strong>Custom Attributes</strong>, that work similarly to HTML attributes. Once we define a Custom Attribute in code we can use it throughout our HTML without writing any additional code.</p>

<h1>How to write a Custom Attribute</h1>

<p>For our example, we&#39;re going to write a custom attribute that instructs the HTML element to read and format markdown code.</p>

<h4>markdown.editor.js</h4>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// In our viewModel, we define the default markdown text using the</span>
<span class="c1">// ES7 Class Properties syntax.</span>
<span class="kr">export</span> <span class="kr">class</span> <span class="nx">MarkdownEditor</span> <span class="p">{</span>
  <span class="nx">mymarkdowntext</span> <span class="o">=</span> <span class="s1">&#39;##markdown\n###is\n#awesome&#39;</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<h4>markdown.editor.html</h4>
<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;template&gt;</span>
  <span class="c">&lt;!-- In our view, we tell Aurelia that we depend on something from the </span>
<span class="c">    file &quot;components/markdown.js&quot;. Aurelia will inspect the file and register</span>
<span class="c">    all the things inside automagically. --&gt;</span>
  <span class="nt">&lt;require</span> <span class="na">from=</span><span class="s">&quot;components/markdown&quot;</span><span class="nt">&gt;&lt;/require&gt;</span>

  <span class="c">&lt;!-- We use the markdown custom attribute and bind it to the value </span>
<span class="c">    &quot;mymarkdowntext&quot; from our viewModel. --&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">markdown</span><span class="err">.</span><span class="na">bind=</span><span class="s">&quot;mymarkdowntext&quot;</span><span class="nt">&gt;&lt;/div&gt;</span>
<span class="nt">&lt;/template&gt;</span>
</code></pre></div>
<h4>components/markdown.js</h4>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// The first thing we need to do is import our dependencies. Here, we&#39;re using</span>
<span class="c1">// the inject decorator from aurelia-framework and Showdown, a markdown parser.</span>
<span class="kr">import</span> <span class="p">{</span> <span class="nx">inject</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;aurelia-framework&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">Showdown</span> <span class="nx">from</span> <span class="s1">&#39;showdown&#39;</span><span class="p">;</span>

<span class="c1">// We create a class called MarkdownCustomAttribute. By giving it this name, we </span>
<span class="c1">// instruct Aurelia to create a custom attribute called &quot;markdown&quot;. When Aurelia</span>
<span class="c1">// finds an HTML element with the &quot;markdown&quot; attribute, it will create a new </span>
<span class="c1">// instance of this class for that attribute. By decorating the class with the </span>
<span class="c1">// @inject(Element) decorator, we tell Aurelia to pass the HTML element as an </span>
<span class="c1">// argument to the constructor function.</span>
<span class="err">@</span><span class="nx">inject</span><span class="p">(</span><span class="nx">Element</span><span class="p">)</span>
<span class="kr">export</span> <span class="kr">class</span> <span class="nx">MarkdownCustomAttribute</span> <span class="p">{</span>  

  <span class="c1">// In our constructor, we capture the HTML element corresponding to this </span>
  <span class="c1">// instance of the markdown attribute. We also instantiate a new Showdown</span>
  <span class="c1">// converter object.</span>
  <span class="nx">constructor</span><span class="p">(</span><span class="nx">element</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">element</span> <span class="o">=</span> <span class="nx">element</span><span class="p">;</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">converter</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Showdown</span><span class="p">.</span><span class="nx">converter</span><span class="p">();</span>
  <span class="p">}</span>

  <span class="c1">// If the custom attribute is bound to a variable--in our case, it is bound to</span>
  <span class="c1">// mymarkdowntext--then Aurelia will call the valueChanged function when the </span>
  <span class="c1">// value of that variable changes. When the variable of our attribute changes,</span>
  <span class="c1">// we want to read and format that value as markdown and insert the output </span>
  <span class="c1">// into the innerHTML of our element.</span>
  <span class="nx">valueChanged</span><span class="p">(</span><span class="nx">newValue</span><span class="p">,</span> <span class="nx">oldValue</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">converter</span><span class="p">.</span><span class="nx">makeHtml</span><span class="p">(</span>
          <span class="nx">newValue</span>
              <span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;\n&#39;</span><span class="p">)</span>
              <span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">line</span> <span class="o">=&gt;</span> <span class="nx">line</span><span class="p">.</span><span class="nx">trim</span><span class="p">())</span>
              <span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;\n&#39;</span><span class="p">)</span>
      <span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h1>Notes</h1>

<p>This particular example uses Aurelia <em>conventions</em> to keep things simple. By default, when you create a class for a custom attribute that follows the naming convention <code>{AttributeName}CustomAttribute</code>, Aurelia does some work behind the scenes to register your Custom Attribute and make it bindable to a single variable. Additionally, it listens to that variable and calls the <code>valueChanged</code> function whenever that value changes. However, all of these conventions are configurable. We will take a look at a more advanced example in a future post.</p>

<h1>Links</h1>

<p><a href="https://davismj.github.io/aurelia-ide/#/markdown-preview">Live example</a><br />
<a href="https://github.com/davismj/aurelia-ide">Full source on GitHub</a><br />
<a href="http://babeljs.io/blog/2015/03/31/5.0.0/">Babel 5 release notes</a><br />
<a href="https://github.com/showdownjs/showdown">Showdown docs</a></p>

</article>
<!-- 
<footer>
	
<div class="comments">
	<div id="disqus_thread"></div>
	<script type="text/javascript">
    
	    var disqus_shortname = 'foursails'; 

	    (function() {
	        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
	        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
	        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	    })();

	</script>
	<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>

</footer> -->
    </main>
    
    
	<!-- Google Analytics -->
	<script>
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
		
		ga('create', 'UA-58706961-2', 'auto');
		ga('send', 'pageview');
	</script>
	<!-- End Google Analytics -->

  </body>
</html>
